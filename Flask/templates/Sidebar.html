<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{url_for('static', filename='styles/Sidebar.css')}}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&family=Roboto:wght@100..900&display=swap" rel="stylesheet">
    <title>AbandonLess</title>
</head>
<body>
    <div class="col-auto min-vh-100">
        <div class="pt-4 pb-1 px-2">
            <a href="#" class="text-black text-decoration-none d-flex align-items-center">
                <img src="{{url_for('static', filename='/Imagens/AbandonLessLogo.png')}}" alt="AbandonLessLogo" class="logo">
            </a>
        </div>
        <hr class="text-white">
        <ul class="nav nav-pills flex-column">
            <li class="nav-item">
                <a href="#" class="nav-link text-black" id="link-previsao">
                    <span class="d-none d-sm-inline main">Previsão</span>
                </a>
                <ul class="nav flex-column ms-3 submenu" style="gap: 4px; padding-top: 4px;" id="previsao-menu">
                    <li>
                        <a href="#" class="text-black submenu-item" style="text-decoration: none; font-size: 0.9rem;"
                           onmouseover="this.style.textDecoration='underline'"
                           onmouseout="this.style.textDecoration='none'">
                            <span>Fazer nova Previsão</span>
                        </a>
                    </li>
                </ul>
            </li>
            {% if session["tipo_utilizador"] == "Data Scientist" %}
            <li class="nav-item">
                <a href="{{url_for('modeloIndex')}}" class="nav-link text-black" id="link-modelacao">
                    <span class="d-none d-sm-inline main">Modelação</span>
                </a>
                <ul class="nav flex-column ms-3 submenu" id="modelacao-menu">
                    <li>
                        <a href="#" class="text-black submenu-item"
                        style="text-decoration: none; font-size: 0.9rem;"
                        onmouseover="this.style.textDecoration='underline'"
                        onmouseout="this.style.textDecoration='none'">
                            <span>Criar Novo Modelo</span>
                        </a>
                    </li>
                </ul>
            </li>
            {% endif %}
            <li class="nav-item">
                <a href="{{url_for('ConjIndex')}}" class="nav-link text-black" id="link-conjuntos">
                    <span class="d-none d-sm-inline main">Conjuntos de Dados</span>
                </a>
                <ul class="nav flex-column ms-3 submenu" style="gap: 4px; padding-top: 4px;" id="conjuntos-menu">
                    <li>
                        <a href="{{ url_for('NovoDataset') }}" class="text-black submenu-item" style="text-decoration: none; font-size: 0.9rem;"
                           onmouseover="this.style.textDecoration='underline'"
                           onmouseout="this.style.textDecoration='none'">
                            <span>Adicionar novo conjunto</span>
                        </a>
                    </li>
                </ul>
                {% if session["dataset_id"] %}
                <ul class="nav flex-column ms-3 submenu" style="gap: 4px; padding-top: 4px;" id="conjuntos-menu2">
                    <li>
                        <a href="#" 
                        class=" submenu-item link-eliminar" 
                        style="font-size: 0.9rem;"
                        onclick="event.preventDefault(); confirmDelete({{ session['dataset_id'] }});">
                            <span>Eliminar Conjunto de Dados</span>
                        </a>
                    </li>
                </ul>
                {% endif %}
            </li>
        </ul>
        <div class="LogOut">
            <img class="iconlog" src="../static/Imagens/icons/logout.png" alt="logout icon">
            <a href="{{ url_for('logout') }}" class="text-black">LogOut</a>
        </div>
    </div>   
    
    <!--Script Para controlar os submenos de acordo com a página atual-->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let currentPage = "{{ current_page }}";  // Página atual do Flask
        
            document.querySelectorAll('.submenu').forEach(menu => menu.style.display = 'none');
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove("active"));
        
            // Mostra apenas o submenu da página atual
            if (currentPage === "Previsão") {
                document.getElementById("previsao-menu").style.display = "block";
                document.getElementById("link-previsao").classList.add("active");
            } else if (currentPage === "Modelacao") {
                document.getElementById("modelacao-menu").style.display = "block";
                document.getElementById("link-modelacao").classList.add("active");
            } else if (currentPage === "ConjuntosDeDados") { 
                document.getElementById("conjuntos-menu").style.display = "block";
                document.getElementById("link-conjuntos").classList.add("active");
            } else if (currentPage === "ConjuntosDeDados2") { 
                document.getElementById("conjuntos-menu2").style.display = "block";
                document.getElementById("link-conjuntos").classList.add("active");
            }
        });
        </script>

        <!--Script Eliminar-->
        <script>
            function confirmDelete(datasetId) {
                console.log("ID recebido:", datasetId);
                datasetId = parseInt(datasetId);
                if (confirm("Deseja eliminar este dataset?")) {
                    fetch(`/removerConjuntodeDados/${datasetId}`, { method: "POST" })
                        .then(response => response.json())
                        .then(data => {
                            alert(data.message);
                            if (data.success) {
                                window.location.href = "{{ url_for('ConjIndex') }}";
                            }
                        })
                        .catch(error => console.error("Erro:", error));
                }
            }
        </script>

</body>
</html>